import{a as f,b as t,c as $}from"./O3VCMV5J.chunk.js";function o(e,n,l){if(e[`${t}muppet`].get(f)&&n!==e[`${t}muppet`].get(f)&&typeof n=="string"&&!n.startsWith(t)&&!e[`${t}methods`][n]){let r=e[`${t}muppet`].get(f);e[`${t}muppet`].set(r,!1);let c=e[`${t}criticalFields`].get(r)||[];e[`${t}criticalFields`].set(r,[...new Set([...c,n])])}return typeof n=="string"&&n.startsWith(t)||n==="__call"?e[n]:e[`${t}methods`][n]?e[`${t}methods`][n]:e[`${t}getter`]?e[`${t}getter`](n):e[`${t}data`][n]}var g=(e,n,l)=>typeof n=="string"&&n.startsWith(t)||n==="__call"?(e[n]=l,!0):(e[`${t}methods`][n]||(e[`${t}data`]={...e[`${t}data`],[n]:l},e[`${t}listeners`][n]&&e[`${t}listeners`][n].size&&e[`${t}listeners`][n].forEach((r,c)=>{e[`${t}muppet`].has(c)&&e[`${t}muppet`].get(c)===!1&&e[`${t}muppet`].set(c,!0),r()}),e[`${t}onUpdate`].length&&e[`${t}onUpdate`].forEach(r=>r&&r(n,l))),!0);function h(e){let n=[],l=e;do n.push(...Object.getOwnPropertyNames(l));while(l=Object.getPrototypeOf(l));return n.sort().filter((r,c,u)=>{if(r!=u[c+1]&&typeof e[r]=="function")return!0})}var E=(e,{main:n,getter:l})=>{try{let r=(()=>{}),c=new $(r),u=new Set(h(e).filter(i=>i!=="constructor"&&typeof e[i]=="function")),m=Object.keys(e).reduce((i,a)=>(u.has(a)||(i[a]=e[a]),i),c),s=new Proxy(m,{set:g,get:o.bind(void 0)}),d=[...u].reduce((i,a)=>a!=="constructor"&&typeof e[a]=="function"?{...i,[a]:e[a].bind(s)}:i,{});return s[`${t}methods`]=d,s[`${t}onUpdate`]=[],s[`${t}data`]=e,s[`${t}criticalFields`]=new Map,s[`${t}muppet`]=new Map,s[`${t}listeners`]=Object.keys(m).reduce((i,a)=>!a.startsWith(t)&&a!=="__call"?{...i,[a]:new Map}:i,{}),l&&(s[`${t}getter`]=l.bind(s)),n&&(s.__call=n.bind(s)),s}catch{}};export{E as a};
