import{a as f,b as t,c as $}from"./KFMMTQSC.chunk.js";var o=(e,n)=>{if(e[`${t}muppet`].get(f)&&n!==e[`${t}muppet`].get(f)&&typeof n=="string"&&!n.startsWith(t)&&!e[`${t}methods`][n]){let s=e[`${t}muppet`].get(f);e[`${t}muppet`].set(s,!1);let r=e[`${t}criticalFields`].get(s)||[];e[`${t}criticalFields`].set(s,[...new Set([...r,n])])}return typeof n=="string"&&n.startsWith(t)||n==="__call"?e[n]:e[`${t}methods`][n]?e[`${t}methods`][n]:e[`${t}getter`]?e[`${t}getter`](n):e[`${t}data`][n]},g=(e,n,s)=>typeof n=="string"&&n.startsWith(t)||n==="__call"?(e[n]=s,!0):(e[`${t}methods`][n]||(e[`${t}data`]={...e[`${t}data`],[n]:s},e[`${t}listeners`][n]&&e[`${t}listeners`][n].size&&e[`${t}listeners`][n].forEach((r,c)=>{e[`${t}muppet`].has(c)&&e[`${t}muppet`].get(c)===!1&&e[`${t}muppet`].set(c,!0),r()}),e[`${t}onUpdate`].length&&e[`${t}onUpdate`].forEach(r=>r&&r(n))),!0);function h(e){let n=[],s=e;do n.push(...Object.getOwnPropertyNames(s));while(s=Object.getPrototypeOf(s));return n.sort().filter((r,c,u)=>{if(r!=u[c+1]&&typeof e[r]=="function")return!0})}var E=(e,{main:n,getter:s})=>{try{let r=(()=>{}),c=new $(r),u=new Set(h(e).filter(i=>i!=="constructor"&&typeof e[i]=="function")),m=Object.keys(e).reduce((i,l)=>(u.has(l)||(i[l]=e[l]),i),c),a=new Proxy(m,{set:g,get:o}),d=[...u].reduce((i,l)=>l!=="constructor"&&typeof e[l]=="function"?{...i,[l]:e[l].bind(a)}:i,{});return a[`${t}methods`]=d,a[`${t}onUpdate`]=[],a[`${t}data`]=e,a[`${t}criticalFields`]=new Map,a[`${t}muppet`]=new Map,a[`${t}listeners`]=Object.keys(m).reduce((i,l)=>!l.startsWith(t)&&l!=="__call"?{...i,[l]:new Map}:i,{}),s&&(a[`${t}getter`]=s.bind(a)),n&&(a.__call=n.bind(a)),a}catch{}};export{E as a};
