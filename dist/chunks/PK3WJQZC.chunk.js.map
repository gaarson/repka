{
  "version": 3,
  "sources": ["../../packages/react-provider/index.ts"],
  "sourcesContent": ["import React from 'react';\nimport { FIELDS_PREFIX } from 'core';\n\nexport function reactProvider<T, M>(parameter?: keyof T): [T, M] {\n  let useSync;\n  let key = React.useId \n    ? React.useId()\n    : React.useRef(parseInt(String((Math.random() * 10000000)), 10).toString()).current\n\n  if (React.useId) {\n    useSync = React.useSyncExternalStore;\n  }\n\n  const state = useSync(notify => {\n    if (this[`${FIELDS_PREFIX}criticalFields`][key]) {\n      this[`${FIELDS_PREFIX}criticalFields`][key].forEach(prop => {\n        if (\n          this[`${FIELDS_PREFIX}listeners`][prop] &&\n          typeof this[`${FIELDS_PREFIX}listeners`][prop] !== 'function'\n        ) this[`${FIELDS_PREFIX}listeners`][prop].set(key, notify);\n      });\n    }\n\n    return () => {\n      if (this[`${FIELDS_PREFIX}criticalFields`][key]) {\n        this[`${FIELDS_PREFIX}muppet`][key] = false;\n        this[`${FIELDS_PREFIX}criticalFields`][key].forEach(prop => {\n          if (\n            this[`${FIELDS_PREFIX}listeners`][prop] &&\n            typeof this[`${FIELDS_PREFIX}listeners`][prop] !== 'function'\n          ) {\n            this[`${FIELDS_PREFIX}listeners`][prop].delete(key);\n          }\n        });\n      }\n    };\n  }, () => {\n    this[`${FIELDS_PREFIX}muppet`]['__PROVIDER_ID__'] = key;\n\n    if (this[`${FIELDS_PREFIX}muppet`][key] === true) {\n      this[`${FIELDS_PREFIX}muppet`]['__PROVIDER_ID__'] = undefined;\n      return this[`${FIELDS_PREFIX}data`];\n    }\n\n    return this;\n  });\n\n  React.useEffect(() => {\n    return () => {\n      if (this[`${FIELDS_PREFIX}muppet`][key] && this[`${FIELDS_PREFIX}criticalFields`][key]) {\n        delete this[`${FIELDS_PREFIX}criticalFields`][key];\n        delete this[`${FIELDS_PREFIX}muppet`][key];\n      }\n    };\n  }, []);\n\n  if (parameter !== undefined) {\n    return state[parameter];\n  }\n\n  return [state, this[`${FIELDS_PREFIX}methods`]];\n}\n"],
  "mappings": ";;;;;AAAA,OAAO,WAAW;AAGX,SAAS,cAAoB,WAA6B;AAC/D,MAAI;AACJ,MAAI,MAAM,MAAM,QACZ,MAAM,MAAM,IACZ,MAAM,OAAO,SAAS,OAAQ,KAAK,OAAO,IAAI,GAAS,GAAG,EAAE,EAAE,SAAS,CAAC,EAAE;AAE9E,MAAI,MAAM,OAAO;AACf,cAAU,MAAM;AAAA,EAClB;AAEA,QAAM,QAAQ,QAAQ,YAAU;AAC9B,QAAI,KAAK,GAAG,aAAa,gBAAgB,EAAE,GAAG,GAAG;AAC/C,WAAK,GAAG,aAAa,gBAAgB,EAAE,GAAG,EAAE,QAAQ,UAAQ;AAC1D,YACE,KAAK,GAAG,aAAa,WAAW,EAAE,IAAI,KACtC,OAAO,KAAK,GAAG,aAAa,WAAW,EAAE,IAAI,MAAM;AACnD,eAAK,GAAG,aAAa,WAAW,EAAE,IAAI,EAAE,IAAI,KAAK,MAAM;AAAA,MAC3D,CAAC;AAAA,IACH;AAEA,WAAO,MAAM;AACX,UAAI,KAAK,GAAG,aAAa,gBAAgB,EAAE,GAAG,GAAG;AAC/C,aAAK,GAAG,aAAa,QAAQ,EAAE,GAAG,IAAI;AACtC,aAAK,GAAG,aAAa,gBAAgB,EAAE,GAAG,EAAE,QAAQ,UAAQ;AAC1D,cACE,KAAK,GAAG,aAAa,WAAW,EAAE,IAAI,KACtC,OAAO,KAAK,GAAG,aAAa,WAAW,EAAE,IAAI,MAAM,YACnD;AACA,iBAAK,GAAG,aAAa,WAAW,EAAE,IAAI,EAAE,OAAO,GAAG;AAAA,UACpD;AAAA,QACF,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF,GAAG,MAAM;AACP,SAAK,GAAG,aAAa,QAAQ,EAAE,iBAAiB,IAAI;AAEpD,QAAI,KAAK,GAAG,aAAa,QAAQ,EAAE,GAAG,MAAM,MAAM;AAChD,WAAK,GAAG,aAAa,QAAQ,EAAE,iBAAiB,IAAI;AACpD,aAAO,KAAK,GAAG,aAAa,MAAM;AAAA,IACpC;AAEA,WAAO;AAAA,EACT,CAAC;AAED,QAAM,UAAU,MAAM;AACpB,WAAO,MAAM;AACX,UAAI,KAAK,GAAG,aAAa,QAAQ,EAAE,GAAG,KAAK,KAAK,GAAG,aAAa,gBAAgB,EAAE,GAAG,GAAG;AACtF,eAAO,KAAK,GAAG,aAAa,gBAAgB,EAAE,GAAG;AACjD,eAAO,KAAK,GAAG,aAAa,QAAQ,EAAE,GAAG;AAAA,MAC3C;AAAA,IACF;AAAA,EACF,GAAG,CAAC,CAAC;AAEL,MAAI,cAAc,QAAW;AAC3B,WAAO,MAAM,SAAS;AAAA,EACxB;AAEA,SAAO,CAAC,OAAO,KAAK,GAAG,aAAa,SAAS,CAAC;AAChD;",
  "names": []
}
