{
  "version": 3,
  "sources": ["../../packages/react-provider/index.ts"],
  "sourcesContent": ["import React from 'react';\nimport { FIELDS_PREFIX } from 'core/domain';\n\nexport function simpleReactProvider<T extends object>(prop: keyof T): T[keyof T] {\n  // if (!React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED?.ReactCurrentDispatcher?.current) {\n  //   return this[`${FIELDS_PREFIX}data`][prop];\n  // }\n\n  try {\n    React.useId();\n  } catch (error) {\n    return this[`${FIELDS_PREFIX}data`][prop];\n  }\n\n  const useSync = React.useSyncExternalStore;\n  if (!useSync) {\n    return this[`${FIELDS_PREFIX}data`][prop];\n  }\n\n  const state = useSync(\n    (notify) => {\n      try {\n        const currentProp = prop;\n\n        if (\n          this[`${FIELDS_PREFIX}listeners`][currentProp] &&\n          typeof this[`${FIELDS_PREFIX}listeners`][currentProp].set === 'function'\n        ) {\n          this[`${FIELDS_PREFIX}listeners`][currentProp].set(notify, notify);\n        }\n\n        if (\n          this[`${FIELDS_PREFIX}criticalFields`] &&\n          typeof this[`${FIELDS_PREFIX}criticalFields`].set === 'function'\n        ) {\n          this[`${FIELDS_PREFIX}criticalFields`].set(notify, [currentProp]);\n        }\n        \n        if (\n          this[`${FIELDS_PREFIX}muppet`] &&\n          typeof this[`${FIELDS_PREFIX}muppet`].set === 'function'\n        ) {\n          this[`${FIELDS_PREFIX}muppet`].set(notify, true);\n        }\n      } catch (err) {\n        console.error(\"Error during subscribe:\", err, prop);\n      }\n\n      return () => {\n        try {\n          this[`${FIELDS_PREFIX}muppet`]?.set(notify, false);\n\n          const fields = this[`${FIELDS_PREFIX}criticalFields`]?.get(notify);\n          if (fields) {\n            fields.forEach(p => {\n              this[`${FIELDS_PREFIX}listeners`][p]?.delete(notify);\n            });\n          }\n\n          this[`${FIELDS_PREFIX}criticalFields`]?.delete(notify);\n          this[`${FIELDS_PREFIX}muppet`]?.delete(notify);\n        } catch (err) {\n          console.error(\"Error during unsubscribe:\", err);\n        }\n      };\n    },\n    () => {\n      try {\n        return this[`${FIELDS_PREFIX}data`];\n      } catch(error) {\n        return {};\n      }\n    },\n    () => {\n      try {\n        return this[`${FIELDS_PREFIX}data`];\n      } catch (error) {\n        return {};\n      }\n    }\n  );\n\n  return state ? state[prop] : this[`${FIELDS_PREFIX}data`][prop];\n}\n"],
  "mappings": ";;;;;AAAA,OAAO,WAAW;AAGX,SAAS,oBAAsC,MAA2B;AAK/E,MAAI;AACF,UAAM,MAAM;AAAA,EACd,SAAS,OAAO;AACd,WAAO,KAAK,GAAG,aAAa,MAAM,EAAE,IAAI;AAAA,EAC1C;AAEA,QAAM,UAAU,MAAM;AACtB,MAAI,CAAC,SAAS;AACZ,WAAO,KAAK,GAAG,aAAa,MAAM,EAAE,IAAI;AAAA,EAC1C;AAEA,QAAM,QAAQ;AAAA,IACZ,CAAC,WAAW;AACV,UAAI;AACF,cAAM,cAAc;AAEpB,YACE,KAAK,GAAG,aAAa,WAAW,EAAE,WAAW,KAC7C,OAAO,KAAK,GAAG,aAAa,WAAW,EAAE,WAAW,EAAE,QAAQ,YAC9D;AACA,eAAK,GAAG,aAAa,WAAW,EAAE,WAAW,EAAE,IAAI,QAAQ,MAAM;AAAA,QACnE;AAEA,YACE,KAAK,GAAG,aAAa,gBAAgB,KACrC,OAAO,KAAK,GAAG,aAAa,gBAAgB,EAAE,QAAQ,YACtD;AACA,eAAK,GAAG,aAAa,gBAAgB,EAAE,IAAI,QAAQ,CAAC,WAAW,CAAC;AAAA,QAClE;AAEA,YACE,KAAK,GAAG,aAAa,QAAQ,KAC7B,OAAO,KAAK,GAAG,aAAa,QAAQ,EAAE,QAAQ,YAC9C;AACA,eAAK,GAAG,aAAa,QAAQ,EAAE,IAAI,QAAQ,IAAI;AAAA,QACjD;AAAA,MACF,SAAS,KAAK;AACZ,gBAAQ,MAAM,2BAA2B,KAAK,IAAI;AAAA,MACpD;AAEA,aAAO,MAAM;AACX,YAAI;AACF,eAAK,GAAG,aAAa,QAAQ,GAAG,IAAI,QAAQ,KAAK;AAEjD,gBAAM,SAAS,KAAK,GAAG,aAAa,gBAAgB,GAAG,IAAI,MAAM;AACjE,cAAI,QAAQ;AACV,mBAAO,QAAQ,OAAK;AAClB,mBAAK,GAAG,aAAa,WAAW,EAAE,CAAC,GAAG,OAAO,MAAM;AAAA,YACrD,CAAC;AAAA,UACH;AAEA,eAAK,GAAG,aAAa,gBAAgB,GAAG,OAAO,MAAM;AACrD,eAAK,GAAG,aAAa,QAAQ,GAAG,OAAO,MAAM;AAAA,QAC/C,SAAS,KAAK;AACZ,kBAAQ,MAAM,6BAA6B,GAAG;AAAA,QAChD;AAAA,MACF;AAAA,IACF;AAAA,IACA,MAAM;AACJ,UAAI;AACF,eAAO,KAAK,GAAG,aAAa,MAAM;AAAA,MACpC,SAAQ,OAAO;AACb,eAAO,CAAC;AAAA,MACV;AAAA,IACF;AAAA,IACA,MAAM;AACJ,UAAI;AACF,eAAO,KAAK,GAAG,aAAa,MAAM;AAAA,MACpC,SAAS,OAAO;AACd,eAAO,CAAC;AAAA,MACV;AAAA,IACF;AAAA,EACF;AAEA,SAAO,QAAQ,MAAM,IAAI,IAAI,KAAK,GAAG,aAAa,MAAM,EAAE,IAAI;AAChE;",
  "names": []
}
