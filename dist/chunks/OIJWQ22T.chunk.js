import{a as f,b as e,c as d}from"./O3VCMV5J.chunk.js";function o(t,n){if(t[`${e}muppet`].get(f)&&n!==t[`${e}muppet`].get(f)&&typeof n=="string"&&!n.startsWith(e)&&!t[`${e}methods`][n]){let s=t[`${e}muppet`].get(f);t[`${e}muppet`].set(s,!1);let l=t[`${e}criticalFields`].get(s)||[];t[`${e}criticalFields`].set(s,[...new Set([...l,n])])}return typeof n=="string"&&n.startsWith(e)||n==="__call"?t[n]:t[`${e}methods`][n]?t[`${e}methods`][n]:t[`${e}getter`]?t[`${e}getter`](n):t[`${e}data`][n]}var g=(t,n,s,l)=>typeof n=="string"&&n.startsWith(e)||n==="__call"?(t[n]=s,!0):(t[`${e}methods`][n]||(t[`${e}data`]={...t[`${e}data`],[n]:s},t[`${e}listeners`][n]&&t[`${e}listeners`][n].size&&t[`${e}listeners`][n].forEach((c,u)=>{t[`${e}muppet`].has(u)&&t[`${e}muppet`].get(u)===!1&&t[`${e}muppet`].set(u,!0),c()}),t[`${e}onUpdate`].length&&t[`${e}onUpdate`].forEach(c=>c&&c(n,s,l))),!0);function y(t){let n=[],s=t;do n.push(...Object.getOwnPropertyNames(s));while(s=Object.getPrototypeOf(s));return n.sort().filter((l,c,u)=>{if(l!=u[c+1]&&typeof t[l]=="function")return!(`${e}data`in t[l])})}var E=(t,{main:n,getter:s})=>{try{let l=(()=>{}),c=new d(l),u=new Set(y(t).filter(a=>a!=="constructor"&&typeof t[a]=="function")),$=Object.keys(t).reduce((a,i)=>(u.has(i)||(a[i]=t[i]),a),c),r=new Proxy($,{set:g,get:o.bind(void 0)}),m=[...u].reduce((a,i)=>i!=="constructor"&&typeof t[i]=="function"?{...a,[i]:t[i].bind(r)}:a,{});return r[`${e}methods`]=m,r[`${e}onUpdate`]=[],r[`${e}data`]=t,r[`${e}criticalFields`]=new Map,r[`${e}muppet`]=new Map,r[`${e}listeners`]=Object.keys($).reduce((a,i)=>!i.startsWith(e)&&i!=="__call"?{...a,[i]:new Map}:a,{}),s&&(r[`${e}getter`]=s.bind(r)),n&&(r.__call=n.bind(r)),r}catch{}};export{E as a};
