var u=Object.defineProperty,m=Object.defineProperties,w=Object.getOwnPropertyDescriptor,k=Object.getOwnPropertyDescriptors,h=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols;var f=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var y=(n,e,r)=>e in n?u(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,g=(n,e)=>{for(var r in e||(e={}))f.call(e,r)&&y(n,r,e[r]);if(c)for(var r of c(e))x.call(e,r)&&y(n,r,e[r]);return n},M=(n,e)=>m(n,k(e));var I=(n,e)=>{for(var r in e)u(n,r,{get:e[r],enumerable:!0})},v=(n,e,r,p)=>{if(e&&typeof e=="object"||typeof e=="function")for(let _ of h(e))!f.call(n,_)&&_!==r&&u(n,_,{get:()=>e[_],enumerable:!(p=w(e,_))||p.enumerable});return n};var O=n=>v(u({},"__esModule",{value:!0}),n);var E={};I(E,{Callable:()=>a,SPECIAL_KEY:()=>s,Source:()=>T,createSource:()=>U});module.exports=O(E);var s="__PROVIDER_ID__",a=class extends Function{constructor(){super();let e;return e=(...r)=>e.__call(...r),Object.setPrototypeOf(e,new.target.prototype)}},T=class extends a{constructor(r,p,_,t){super();this.__call=r;this.__methods=_;this.__onUpdate=[];this.__listeners={};this.__criticalFields={};this.call=void 0,this.muppet=new Proxy({__init__:p},{get:t.bind(this)});for(let i in p)this.__listeners[i]=new Map,this[i]=p[i]}},U=(n,e,r)=>{function p(t,i){return t[s]&&typeof t[s]=="string"&&i!==t[s]&&i!=="__init__"&&(t[t[s]]=!1,this.__criticalFields[t[s]]=[...this.__criticalFields[t[s]]||[],i]),i==="__init__"?t.__init__:t[i]===void 0?t.__init__[i]:t[i]}function _(t,i,l){return t[i]=l,t.muppet.__init__=M(g({},t.muppet.__init__),{[i]:l}),t.__listeners[i]&&t.__listeners[i].size&&t.__listeners[i].forEach((d,o)=>{t.muppet[o]!==void 0&&t.muppet[o]===!1&&(t.muppet[o]=!0),d()}),Array.isArray(t.__onUpdate)&&i!=="__onUpdate"&&(t.__onUpdate.forEach(d=>d()),t.__onUpdate=[]),!0}return new Proxy(new T(e,n,r,p),{set:_})};
