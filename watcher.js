var T=Object.defineProperty,b=Object.defineProperties,O=Object.getOwnPropertyDescriptor,k=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertyNames,_=Object.getOwnPropertySymbols;var g=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var h=(r,e,n)=>e in r?T(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,l=(r,e)=>{for(var n in e||(e={}))g.call(e,n)&&h(r,n,e[n]);if(_)for(var n of _(e))I.call(e,n)&&h(r,n,e[n]);return r},c=(r,e)=>b(r,k(e));var M=(r,e)=>{for(var n in e)T(r,n,{get:e[n],enumerable:!0})},x=(r,e,n,p)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of m(e))!g.call(r,t)&&t!==n&&T(r,t,{get:()=>e[t],enumerable:!(p=O(e,t))||p.enumerable});return r};var v=r=>x(T({},"__esModule",{value:!0}),r);var j={};M(j,{Watcher:()=>u,watcherCreator:()=>C});module.exports=v(j);var s="__PROVIDER_ID__",y=class extends Function{constructor(){super();let e;return e=(...n)=>e.__call(...n),Object.setPrototypeOf(e,new.target.prototype)}},d=class extends y{constructor(n,p,t,i){super();this.__call=n;this.__methods=t;this.__onUpdate=[];this.__listeners={};this.call=void 0;for(let o in p)this[o]=p[o];this.muppet=new Proxy({},{get:i.bind(this)})}},f=(r,e,n)=>{function p(t,i){return t[s]&&typeof t[s]=="string"&&i!==t[s]&&(t[t[s]]?t[t[s]]=c(l({},t[t[s]]),{[i]:this[i]!==void 0?this[i]:void 0}):t[t[s]]={[i]:this[i]!==void 0?this[i]:void 0}),t[i]?t[i]:this[i]}return new Proxy(new d(e,r,n,p),{set(t,i,o){if(t[i]=o,t.__listeners[i]&&t.__listeners[i].size)for(let[a,w]of t.__listeners[i])t.muppet[a]&&(t.muppet[a]=c(l({},t.muppet[a]),{[i]:o})),w();return Array.isArray(t.__onUpdate)&&i!=="onUpdate"&&(t.__onUpdate.forEach(a=>a()),t.__onUpdate=[]),!0}})};var u=class{constructor(){this.SPECIAL_KEY=s}init(e,n,p){typeof e=="object"&&(this.sourceObj=f(e,n,p))}set(e,n){this.sourceObj&&e!=="name"&&e!=="length"&&(this.sourceObj[e]=n)}get(e){if(this.sourceObj&&e)return this.sourceObj[e]}watch(e){return new Promise(n=>{this.sourceObj.__onUpdate=[...this.sourceObj.__onUpdate,()=>{this.sourceObj[e]&&n(this.sourceObj[e])}]})}watchFor(e,n){return new Promise(p=>{this.sourceObj.__onUpdate=[...this.sourceObj.__onUpdate,()=>{this.sourceObj[e]===n&&p(this.sourceObj[e])}]})}},C=(r,e,n)=>{let p=new u;return p.init(r,e,n),p};
